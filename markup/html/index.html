<!doctype html>
<html lang="ko">
  <head>
    <script>
      // í˜ì´ì§€ ë¡œë“œ ì‹œ ì‹¤í–‰
      if (!localStorage.getItem("startVisit")) {
        window.location.href = "./intro.html";
      } else {
        localStorage.setItem("lastVisit", new Date().toISOString());
      }
    </script>
    @@include("_include/_head.html")
    <link rel="stylesheet" type="text/css" href="./assets/css/main.css" />
  </head>
  <body>
    <div class="wrap main">
      @@include("_include/_header.html")
      <!-- container -->
      <div class="container">
        <div class="bg-circle">
          <ul>
            <li><div></div></li>
            <li></li>
            <li></li>
            <li></li>
          </ul>
        </div>
        <div class="learning-area">
          <svg
            id="gauge"
            viewBox="0 0 794 460"
            preserveAspectRatio="xMidYMid meet"
          ></svg>
        </div>
        <div class="main-contents">
          <div class="text-box">
            <span><em>í™ê¸¸ë™</em> ì„ ì„ì—°êµ¬ì›ë‹˜</span>
            <div class="keyword-area">
              <button id="keywordSettingsBtn">
                ë‚˜ì˜ í‚¤ì›Œë“œ <i class="ico-setting"></i>
              </button>
              <div class="keyword-list" id="myKeyword">
                <label class="kw-allow" for="chk1">
                  <input type="checkbox" id="chk1" />
                  #ì¸ë¬¼
                </label>
                <label class="kw-allow" for="chk2">
                  <input type="checkbox" id="chk2" checked />
                  #ì†Œí†µ
                </label>
                <label class="kw-allow" for="chk3">
                  <input type="checkbox" id="chk3" checked />
                  #í˜‘ì—…
                </label>
              </div>
              <div class="keyword-list">
                <label class="kw-deny" for="chk4">
                  <input type="checkbox" id="chk4" checked />
                  #ë§ˆì¸ë“œì…‹
                </label>
                <label class="kw-deny" for="chk5">
                  <input type="checkbox" id="chk5" />
                  #ì›°ë‹ˆìŠ¤
                </label>
              </div>
            </div>
            <p><em>ì·¨í–¥ì €ê²© ì˜ìƒ ì¶”ì²œ</em>ë“œë ¤ìš”.</p>
          </div>

          <div class="video-wrap">
            <!-- ë¹„ë””ì˜¤ ì¹´ë“œ ì»¨í…Œì´ë„ˆ -->
            <div class="video-cards-container" id="videoCardsContainer"></div>
            <!-- ë„¤ë¹„ê²Œì´ì…˜ ë²„íŠ¼ -->
            <button class="btn-prev" id="prevBtn">â€¹</button>
            <button class="btn-next" id="nextBtn">â€º</button>
            <!-- í˜ì´ì§€ë„¤ì´ì…˜ -->
            <div class="pagination" id="pagination">
              <span class="current">1</span> / 1
            </div>
          </div>

          <!-- keyword modal -->
          <div class="modal keyword" id="keywordModal">
            @@include("_modal/keyword.html")
          </div>
          <!-- // keyword modal -->
        </div>
      </div>

      <!-- // container -->
      @@include("guide.html")
    </div>

    <!-- ì„¤ì • ë° ì´ˆê¸°í™” -->
    <script type="module">
      import { KeywordManager } from "./assets/js/keyword.js";
      import { VideoManager } from "./assets/js/video.js";
      import { GaugeChart } from "./assets/js/gauge.js";

      // ============================================
      // ğŸ“‹ ì„¤ì • (Config)
      // ============================================
      const CONFIG = {
        // ë¹„ë””ì˜¤ ë°ì´í„°
        videos: [
          {
            id: 1,
            url: "IZm1m_FKmc0",
            category: "ë¦¬ë”ì‹­",
            title: "ì •ì„ ê·¼ êµìˆ˜ê°€ ì•Œë ¤ì£¼ëŠ” ëª©ë””ìŠ¤í¬ ì§€ì‹",
            pick: true,
            person: "í™ê¸¸ë™",
            type: "main",
            keywords: ["ì†Œí†µ", "ì „ë¬¸ê°€"],
            gauge: 80,
          },
          {
            id: 2,
            url: "3CR-FmeOu2U",
            category: "ì¸ì‚¬ì´íŠ¸",
            title: "ê¸°êº¼ì´ 'ì´ ë§'ì„ ë‚´ ë±‰ì„ ì¤„ ì•Œì•„ì•¼ ì¸ì •ë°›ëŠ”ë‹¤",
            type: "comment",
            keywords: ["ë§ˆì¸ë“œì…‹", "ìê¸°ê°œë°œ"],
            gauge: 30,
          },
          {
            id: 3,
            url: "-X6GV6MvgSQ",
            category: "ì¸ì‚¬ì´íŠ¸",
            type: "onboarding",
            title: "íšŒê³„ë¥¼ ì¡°ê¸ˆì´ë¼ë„ ì´í•´í•˜ë©´ ì¸ìƒì´ ë‹¬ë¼ì§‘ë‹ˆë‹¤",
            keywords: ["ì†Œí†µ", "ì½”ì¹­"],
            gauge: 50,
          },
          {
            id: 4,
            url: "-yRS3yGGnDU",
            category: "ë¦¬ë”ì‹­",
            type: "learning",
            title: "ì‚°ì—…ì¬í•´ì˜ˆë°© ì•ˆì „ìˆ˜ì¹™",
            keywords: ["ì†Œí†µ", "ì¤‘ê°„ê´€ë¦¬ì"],
          },
          {
            id: 5,
            url: "FUXT_m6nzhg",
            category: "ì¸ì‚¬ì´íŠ¸",
            type: "main",
            title: "ì •ì„ ê·¼ êµìˆ˜ê°€ ì•Œë ¤ì£¼ëŠ” ëª©ë””ìŠ¤í¬ ì§€ì‹",
            keywords: ["ì†Œí†µ", "ì „ë¬¸"],
          },
          {
            id: 6,
            url: "nLL409se8sM",
            category: "ë¹„ì¦ˆíŠ¸ë Œë“œ",
            type: "comment",
            title: "3/2 - ì´ëŒ€í˜¸ì˜ ë³„ì±…ë¶€ë¡ [1ì¡° ì—¬í–‰ ê¿€íŒ]",
            keywords: ["ë™ê¸°ë¶€ì—¬", "AI"],
          },
          {
            id: 7,
            url: "XKqLz6WJSRA",
            category: "ë¦¬ë”ì‹­",
            type: "learning",
            title: "íš¨ê³¼ì ì¸ í˜‘ì—…ì„ ìœ„í•œ 5ê°€ì§€ ì›ì¹™",
            keywords: ["í˜‘ì—…", "ì „ë¬¸ê°€"],
          },
          {
            id: 8,
            url: "3U0cbzmwSYc",
            category: "ì¸ì‚¬ì´íŠ¸",
            type: "onboarding",
            title: "íŒ€ ìƒì‚°ì„±ì„ ë†’ì´ëŠ” í˜‘ì—… ë„êµ¬",
            keywords: ["ì„±ì¥", "ì½”ì¹­"],
          },
        ],

        // ìµœëŒ€ í‚¤ì›Œë“œ ì„ íƒ ê°œìˆ˜
        maxAllowKeywords: 5,

        // ì´ˆê¸° ì„ íƒ í‚¤ì›Œë“œ (HTMLê³¼ ì¼ì¹˜ì‹œì¼œì•¼ í•¨)
        initialAllowKeywords: ["ì†Œí†µ", "í˜‘ì—…"],
        initialDenyKeywords: ["ë§ˆì¸ë“œì…‹"],

        // í˜ì´ì§€ë‹¹ ì˜ìƒ ê°œìˆ˜
        videosPerPage: 6,

        // ì• ë‹ˆë©”ì´ì…˜ ë”œë ˆì´ (ms)
        animationDelay: 100,

        // ê²Œì´ì§€ ì„¤ì •
        gauge: {
          size: 832,
          maxValue: 50, //ì „ì²´ í•™ìŠµ ì‹œê°„
          strokeWidth: 31,
          padding: 20,
          outerTextOffset: 6,
          innerTextOffset: 35,
          dotRadius: 7,
        },
      };

      // ============================================
      // ğŸš€ ì•± ì´ˆê¸°í™”
      // ============================================
      let keywordManager, videoManager, gaugeChart;

      function initApp() {
        // í‚¤ì›Œë“œ ë§¤ë‹ˆì € ì´ˆê¸°í™”
        keywordManager = new KeywordManager({
          initialAllowKeywords: CONFIG.initialAllowKeywords,
          initialDenyKeywords: CONFIG.initialDenyKeywords,
          maxAllowKeywords: CONFIG.maxAllowKeywords,
          onKeywordChange: () => {
            videoManager.refresh();
          },
        });

        // ë¹„ë””ì˜¤ ë§¤ë‹ˆì € ì´ˆê¸°í™”
        videoManager = new VideoManager({
          videos: CONFIG.videos,
          videosPerPage: CONFIG.videosPerPage,
          animationDelay: CONFIG.animationDelay,
          getKeywords: () => keywordManager.getSelectedKeywords(),
        });

        // ê²Œì´ì§€ ì°¨íŠ¸ ì´ˆê¸°í™”
        gaugeChart = new GaugeChart(CONFIG.gauge, CONFIG.maxValue);

        // ì´ˆê¸°í™” ì‹¤í–‰
        keywordManager.init();
        videoManager.init();
        gaugeChart.init();
        gaugeChart.update(30); // ë‚˜ì˜ í•™ìŠµ ì‹œê°„

        if (typeof window.keywordChange === "function") {
          window.keywordChange();
        }

        console.log("ì´ˆê¸°í™” ì™„ë£Œ!");
      }

      // DOM ë¡œë“œ í›„ ì´ˆê¸°í™”
      if (document.readyState === "loading") {
        document.addEventListener("DOMContentLoaded", initApp);
      } else {
        initApp();
      }
    </script>
  </body>
</html>
