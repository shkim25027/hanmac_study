<!doctype html>
<html lang="ko">
  <head>
    <script>
      // í˜ì´ì§€ ë¡œë“œ ì‹œ ì‹¤í–‰
      if (!localStorage.getItem("startVisit")) {
        window.location.href = "./intro.html"; // intro í˜ì´ì§€ ê²½ë¡œ
      } else {
        // ì ‘ì†ì¼ ê°±ì‹ 
        localStorage.setItem("lastVisit", new Date().toISOString());
      }
    </script>
    @@include("_include/_head.html")
    <link rel="stylesheet" type="text/css" href="./assets/css/main.css" />
  </head>
  <body>
    <div class="wrap main">
      @@include("_include/_header.html")
      <!-- container -->
      <div class="container">
        <div class="bg-circle">
          <ul>
            <li>
              <div></div>
            </li>
            <li></li>
            <li></li>
            <li></li>
          </ul>
        </div>
        <div class="learning-area">
          <svg
            id="gauge"
            viewBox="0 0 794 460"
            preserveAspectRatio="xMidYMid meet"
          ></svg>
        </div>
        <div class="main-contents">
          <div class="text-box">
            <span><em>í™ê¸¸ë™</em> ì„ ì„ì—°êµ¬ì›ë‹˜</span>
            <div class="keyword-area">
              <button id="keywordSettingsBtn">
                ë‚˜ì˜ í‚¤ì›Œë“œ <i class="ico-setting"></i>
              </button>
              <div class="keyword-list" id="myKeyword">
                <label class="kw-allow" for="chk1">
                  <input type="checkbox" id="chk1" />
                  #ì¸ë¬¼
                </label>
                <label class="kw-allow" for="chk2">
                  <input type="checkbox" id="chk2" checked />
                  #ì†Œí†µ
                </label>
                <label class="kw-allow" for="chk3">
                  <input type="checkbox" id="chk3" checked />
                  #í˜‘ì—…
                </label>
                <label class="kw-deny" for="chk4">
                  <input type="checkbox" id="chk4" checked />
                  #ë§ˆì¸ë“œì…‹
                </label>
                <label class="kw-deny" for="chk5">
                  <input type="checkbox" id="chk5" />
                  #ì›°ë‹ˆìŠ¤
                </label>
              </div>
            </div>
            <p><em>ì·¨í–¥ì €ê²© ì˜ìƒ ì¶”ì²œ</em>ë“œë ¤ìš”.</p>
          </div>

          <div class="video-wrap">
            <!-- ë¹„ë””ì˜¤ ì¹´ë“œ ì»¨í…Œì´ë„ˆ -->
            <div class="video-cards-container" id="videoCardsContainer"></div>
            <!-- ë„¤ë¹„ê²Œì´ì…˜ ë²„íŠ¼ -->
            <button class="btn-prev" id="prevBtn">â€¹</button>
            <button class="btn-next" id="nextBtn">â€º</button>
            <!-- í˜ì´ì§€ë„¤ì´ì…˜ -->
            <div class="pagination" id="pagination">
              <span class="current">1</span> / 1
            </div>
          </div>

          <!-- // keyword modal-->
          <div class="modal keyword" id="keywordModal">
            <div class="modal-content">
              <div class="modal-header">
                ë‚˜ì˜ í‚¤ì›Œë“œ ìˆ˜ì •<i class="ico-check"></i>
              </div>
              <div class="modal-body" id="modalBody">
                <ul class="keyword-tag">
                  <li class="kw-box">
                    <label for="kwtag_1">
                      <input type="checkbox" id="kwtag_1" disabled /> #ì˜¨ë³´ë”©
                    </label>
                    <input type="checkbox" class="kw-add" />
                  </li>
                  <li class="kw-box">
                    <label for="kwtag_2">
                      <input type="checkbox" id="kwtag_2" disabled /> #ì„±ì¥
                    </label>
                    <input type="checkbox" class="kw-add" />
                  </li>
                  <li class="kw-box">
                    <label for="kwtag_3">
                      <input type="checkbox" id="kwtag_3" disabled /> #ì½”ì¹­
                    </label>
                    <input type="checkbox" class="kw-add" />
                  </li>
                  <li class="kw-box">
                    <label for="kwtag_4">
                      <input type="checkbox" id="kwtag_4" /> #ì¸ë¬¼
                    </label>
                    <input type="checkbox" class="kw-add" checked />
                  </li>
                  <li class="kw-box">
                    <label for="kwtag_5">
                      <input type="checkbox" id="kwtag_5" checked /> #ì†Œí†µ
                    </label>
                    <input type="checkbox" class="kw-add" checked />
                  </li>
                  <li class="kw-box">
                    <label for="kwtag_6">
                      <input type="checkbox" id="kwtag_6" checked /> #í˜‘ì—…
                    </label>
                    <input type="checkbox" class="kw-add" checked />
                  </li>
                  <li class="kw-box">
                    <label for="kwtag_7">
                      <input type="checkbox" id="kwtag_7" disabled /> AI
                    </label>
                    <input type="checkbox" class="kw-add" />
                  </li>
                  <li class="kw-box">
                    <label for="kwtag_8">
                      <input type="checkbox" id="kwtag_8" disabled /> ITí…Œí¬
                    </label>
                    <input type="checkbox" class="kw-add" />
                  </li>
                  <li class="kw-box">
                    <label for="kwtag_9">
                      <input type="checkbox" id="kwtag_9" disabled />
                      #ì¤‘ê°„ê´€ë¦¬ì
                    </label>
                    <input type="checkbox" class="kw-add" />
                  </li>
                  <li class="kw-box">
                    <label for="kwtag_10">
                      <input type="checkbox" id="kwtag_10" disabled /> #ë¦¬ë”ì‹­
                    </label>
                    <input type="checkbox" class="kw-add" />
                  </li>
                  <li class="kw-box">
                    <label for="kwtag_11">
                      <input type="checkbox" id="kwtag_11" disabled /> #íŒ”ë¡œìš°ì‹­
                    </label>
                    <input type="checkbox" class="kw-add" />
                  </li>
                  <li class="kw-box">
                    <label for="kwtag_12">
                      <input type="checkbox" id="kwtag_12" disabled /> #ë™ê¸°ë¶€ì—¬
                    </label>
                    <input type="checkbox" class="kw-add" />
                  </li>
                  <li class="kw-box">
                    <label for="kwtag_13">
                      <input type="checkbox" id="kwtag_13" disabled /> #ì¸ê°„ê´€ê³„
                    </label>
                    <input type="checkbox" class="kw-add" />
                  </li>
                  <li class="kw-box">
                    <label for="kwtag_14">
                      <input type="checkbox" id="kwtag_14" disabled /> #ìŠ¤í‚¬ì—…
                    </label>
                    <input type="checkbox" class="kw-add" />
                  </li>
                  <li class="kw-box">
                    <label for="kwtag_15">
                      <input type="checkbox" id="kwtag_15" disabled /> #í”¼ë“œë°±
                    </label>
                    <input type="checkbox" class="kw-add" />
                  </li>
                  <li class="kw-box">
                    <label for="kwtag_16">
                      <input type="checkbox" id="kwtag_16" disabled /> #ì»¤ë¦¬ì–´
                    </label>
                    <input type="checkbox" class="kw-add" />
                  </li>
                  <li class="kw-box">
                    <label for="kwtag_17">
                      <input type="checkbox" id="kwtag_17" disabled /> #ê²½ì˜
                    </label>
                    <input type="checkbox" class="kw-add" />
                  </li>
                  <li class="kw-box">
                    <label for="kwtag_18">
                      <input type="checkbox" id="kwtag_18" disabled /> #ê²½ì œ
                    </label>
                    <input type="checkbox" class="kw-add" />
                  </li>
                </ul>
              </div>
            </div>
          </div>
          <!-- // keyword modal-->
        </div>
      </div>
      <!-- // container -->
    </div>

    <script>
      const svg = document.getElementById("gauge");
      const size = 832;
      const center = size / 2;
      const strokeWidth = 31;
      const maxValue = 140;

      // ë‚´ë¶€ ì¢Œí‘œê³„ëŠ” ê³ ì •!
      // ì‹¤ì œ í™”ë©´ í¬ê¸°ì™€ ê´€ê³„ ì—†ìŒ
      svg.setAttribute("viewBox", `0 0 ${size} ${size}`);
      svg.setAttribute("preserveAspectRatio", "xMidYMid meet");

      // ì—¬ë°± 20 ì¶”ê°€ â†’ íŠ€ì–´ë‚˜ê°€ì§€ ì•ŠìŒ
      const radius = size / 2 - strokeWidth / 2 - 20;

      // ì˜¤í”„ì…‹ 40 ì œê±°
      function ptc(cx, cy, r, angle) {
        const rad = (angle * Math.PI) / 180;
        return { x: cx + r * Math.cos(rad), y: cy + r * Math.sin(rad) };
      }

      function arc(r, start, end) {
        const s = ptc(center, center, r, start);
        const e = ptc(center, center, r, end);
        return `M ${s.x} ${s.y} A ${r} ${r} 0 0 1 ${e.x} ${e.y}`;
      }

      function updateGauge(value) {
        svg.innerHTML = "";

        const percent = Math.min(value / maxValue, 1);
        const angle = -180 + percent * 180;

        // ë°°ê²½ ë°˜ì›
        const bg = document.createElementNS(
          "http://www.w3.org/2000/svg",
          "path"
        );
        bg.setAttribute("d", arc(radius, -180, 0));
        bg.setAttribute("stroke", "#f2dfc7");
        bg.setAttribute("stroke-width", strokeWidth);
        bg.setAttribute("stroke-linecap", "square");
        bg.setAttribute("fill", "none");
        svg.appendChild(bg);

        // ì±„ì›Œì§„ ë°˜ì›
        const fg = document.createElementNS(
          "http://www.w3.org/2000/svg",
          "path"
        );
        fg.setAttribute("d", arc(radius, -180, angle));
        fg.setAttribute("stroke", "#e89555");
        fg.setAttribute("stroke-width", strokeWidth);
        fg.setAttribute("stroke-linecap", "round");
        fg.setAttribute("fill", "none");
        svg.appendChild(fg);

        // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        // ğŸ”¥ í…ìŠ¤íŠ¸ìš© ì•„í¬ 2ê°œ (ê²‰/ì•ˆìª½)
        // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        const defs = document.createElementNS(
          "http://www.w3.org/2000/svg",
          "defs"
        );

        // ì™¸ê³½ í…ìŠ¤íŠ¸: "ë‚˜ì˜ í•™ìŠµ : xxë¶„"
        const outerArc = document.createElementNS(
          "http://www.w3.org/2000/svg",
          "path"
        );
        outerArc.setAttribute("id", "outerArc");
        outerArc.setAttribute("d", arc(radius - 6, -180, 0));
        defs.appendChild(outerArc);

        // ë‚´ë¶€ í…ìŠ¤íŠ¸: "ì „ì²´ í‰ê·  í•™ìŠµ : xxë¶„"
        const innerArc = document.createElementNS(
          "http://www.w3.org/2000/svg",
          "path"
        );
        innerArc.setAttribute("id", "innerArc");
        innerArc.setAttribute("d", arc(radius - 35, -180, 0)); // ì•ˆìª½ìœ¼ë¡œ ì´ë™
        defs.appendChild(innerArc);

        svg.appendChild(defs);

        // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        // ğŸ”¥ "ë‚˜ì˜ í•™ìŠµ"
        // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        if (percent > 0.15) {
          const text = document.createElementNS(
            "http://www.w3.org/2000/svg",
            "text"
          );
          text.setAttribute("font-size", "15");
          text.setAttribute("font-weight", "600");
          text.setAttribute("fill", "#000");

          const tp = document.createElementNS(
            "http://www.w3.org/2000/svg",
            "textPath"
          );
          tp.setAttributeNS(
            "http://www.w3.org/1999/xlink",
            "xlink:href",
            "#outerArc"
          );
          tp.setAttribute("startOffset", `${Math.max(10, percent * 100 - 6)}%`);
          tp.setAttribute("text-anchor", "middle");
          tp.textContent = `ë‚˜ì˜ í•™ìŠµ : ${value}ë¶„`;

          text.appendChild(tp);
          svg.appendChild(text);
        }

        // ëì  ì›
        const p = ptc(center, center, radius, angle);
        const dot = document.createElementNS(
          "http://www.w3.org/2000/svg",
          "circle"
        );
        dot.setAttribute("cx", p.x);
        dot.setAttribute("cy", p.y);
        dot.setAttribute("r", 7);
        dot.setAttribute("fill", "#804514");
        svg.appendChild(dot);

        // ëì  ì•„ì´ì½˜
        const ico = ptc(center, center, radius, angle);

        const icon = document.createElementNS(
          "http://www.w3.org/2000/svg",
          "g"
        );
        icon.setAttribute(
          "transform",
          `translate(${ico.x - 4}, ${ico.y - 3.5})`
        );
        icon.innerHTML = `
        <path d="M7.25859 5.72241C7.45848 6.05134 7.22735 6.47331 6.84254 6.48196L0.511261 6.62427C-0.0386892 6.63663 -0.202465 5.88127 0.303221 5.66476L3.21705 4.41716C3.42672 4.32738 3.54907 4.10709 3.51446 3.88165L3.00742 0.578948C2.92444 0.0384521 3.64493 -0.223896 3.92892 0.243408L7.25859 5.72241Z" fill="#E28A41"/>
      `;

        svg.appendChild(icon);

        // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        // ğŸ”¥ "ì „ì²´ í‰ê·  í•™ìŠµ" (ê²Œì´ì§€ ì•ˆìª½)
        // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        const maxText = document.createElementNS(
          "http://www.w3.org/2000/svg",
          "text"
        );
        maxText.setAttribute("font-size", "15");
        maxText.setAttribute("font-weight", "400");
        maxText.setAttribute("fill", "#4A4947");

        const maxLabel = document.createElementNS(
          "http://www.w3.org/2000/svg",
          "textPath"
        );
        maxLabel.setAttributeNS(
          "http://www.w3.org/1999/xlink",
          "xlink:href",
          "#innerArc"
        );
        maxLabel.setAttribute("startOffset", "100%"); // ìœ„ì¹˜ ë¯¸ì„¸ì¡°ì • ê°€ëŠ¥
        maxLabel.setAttribute("text-anchor", "end");
        maxLabel.innerHTML = `ì „ì²´ í‰ê·  í•™ìŠµ : <tspan font-weight="700">${maxValue}</tspan>ë¶„`;

        maxText.appendChild(maxLabel);
        svg.appendChild(maxText);
      }

      updateGauge(100);
    </script>
    <script src="../assets/js/kw_tag.js"></script>
    <script>
      // ============================================
      // ë°ì´í„° ì •ì˜
      // ============================================
      const allVideos = [
        {
          id: "IZm1m_FKmc0",
          category: "ë¦¬ë”ì‹­",
          title: "ì •ì„ ê·¼ êµìˆ˜ê°€ ì•Œë ¤ì£¼ëŠ” ëª©ë””ìŠ¤í¬ ì§€ì‹",
          keywords: ["ì†Œí†µ", "ì „ë¬¸ê°€"],
        },
        {
          id: "3CR-FmeOu2U",
          category: "ì¸ì‚¬ì´íŠ¸",
          title: "ê¸°êº¼ì´ 'ì´ ë§'ì„ ë‚´ ë±‰ì„ ì¤„ ì•Œì•„ì•¼ ì¸ì •ë°›ëŠ”ë‹¤",
          keywords: ["ë§ˆì¸ë“œì…‹", "ìê¸°ê°œë°œ"],
        },
        {
          id: "-X6GV6MvgSQ",
          category: "ì¸ì‚¬ì´íŠ¸",
          title: "íšŒê³„ë¥¼ ì¡°ê¸ˆì´ë¼ë„ ì´í•´í•˜ë©´ ì¸ìƒì´ ë‹¬ë¼ì§‘ë‹ˆë‹¤",
          keywords: ["ì†Œí†µ", "ì½”ì¹­"],
        },
        {
          id: "-yRS3yGGnDU",
          category: "ë¦¬ë”ì‹­",
          title: "ì„±ì¥í•˜ëŠ” ì‚¬ëŒì€ 'OO ë§ˆì¸ë“œ'ì…‹",
          keywords: ["ë§ˆì¸ë“œì…‹", "ì¤‘ê°„ê´€ë¦¬ì"],
        },
        {
          id: "FUXT_m6nzhg",
          category: "ì¸ì‚¬ì´íŠ¸",
          title: "ì •ì„ ê·¼ êµìˆ˜ê°€ ì•Œë ¤ì£¼ëŠ” ëª©ë””ìŠ¤í¬ ì§€ì‹",
          keywords: ["ì†Œí†µ", "ì „ë¬¸"],
        },
        {
          id: "nLL409se8sM",
          category: "ë¹„ì¦ˆíŠ¸ë Œë“œ",
          title: "3/2 - ì´ëŒ€í˜¸ì˜ ë³„ì±…ë¶€ë¡ [1ì¡° ì—¬í–‰ ê¿€íŒ]",
          keywords: ["ë™ê¸°ë¶€ì—¬", "AI"],
        },
        {
          id: "XKqLz6WJSRA",
          category: "ë¦¬ë”ì‹­",
          title: "íš¨ê³¼ì ì¸ í˜‘ì—…ì„ ìœ„í•œ 5ê°€ì§€ ì›ì¹™",
          keywords: ["í˜‘ì—…", "ì „ë¬¸ê°€"],
        },
        {
          id: "3U0cbzmwSYc",
          category: "ì¸ì‚¬ì´íŠ¸",
          title: "íŒ€ ìƒì‚°ì„±ì„ ë†’ì´ëŠ” í˜‘ì—… ë„êµ¬",
          keywords: ["ì„±ì¥", "ì½”ì¹­"],
        },
        {
          id: "KE_MeQZgnPM",
          category: "ë¦¬ë”ì‹­",
          title: "ì›ê²© ê·¼ë¬´ ì‹œëŒ€ì˜ í˜‘ì—… ì „ëµ",
          keywords: ["ITí…Œí¬", "ë¦¬ë”ì‹­"],
        },
        {
          id: "lnAo866WXgs",
          category: "ì¸ì‚¬ì´íŠ¸",
          title: "ê°ˆë“±ì„ ê¸°íšŒë¡œ ë§Œë“œëŠ” í˜‘ì—… ê¸°ìˆ ",
          keywords: ["í˜‘ì—…", "ìŠ¤í‚¬ì—…"],
        },
        {
          id: "wWcn4fRcVXI",
          category: "ë¹„ì¦ˆíŠ¸ë Œë“œ",
          title: "ì• ìì¼ ë°©ì‹ìœ¼ë¡œ ì¼í•˜ëŠ” ë²•",
          keywords: ["ì„±ì¥", "ì½”ì¹­"],
        },
        {
          id: "wWcn4fRcVXI",
          category: "ë¹„ì¦ˆíŠ¸ë Œë“œ",
          title: "í¬ë¡œìŠ¤í‘ì…”ë„ íŒ€ ìš´ì˜ ë…¸í•˜ìš°",
          keywords: ["íŒ”ë¡œìš°ì‹­", "ì˜¨ë³´ë”©"],
        },
        {
          id: "2tKKgXcaXUg",
          category: "ë¦¬ë”ì‹­",
          title: "2025ë…„ ë¦¬ë”ê°€ ê°–ì¶°ì•¼ í•  ì—­ëŸ‰",
          keywords: ["ê²½ì˜", "ê²½ì œ"],
        },
      ];

      // ============================================
      // ìƒíƒœ ê´€ë¦¬
      // ============================================
      const STATE = {
        selectedKeywords: ["ì†Œí†µ", "í˜‘ì—…", "ë§ˆì¸ë“œì…‹"],
        currentPage: 0,
        VIDEOS_PER_PAGE: 6,
        cachedVideos: [],
      };

      // ============================================
      // ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜
      // ============================================
      const Utils = {
        // Fisher-Yates ì•Œê³ ë¦¬ì¦˜ì„ ì´ìš©í•œ ë°°ì—´ ì„ê¸°
        shuffleArray(array) {
          const shuffled = [...array];
          for (let i = shuffled.length - 1; i > 0; i--) {
            const j = Math.floor(Math.random() * (i + 1));
            [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];
          }
          return shuffled;
        },

        // ì¹´í…Œê³ ë¦¬ì— ë”°ë¥¸ CSS í´ë˜ìŠ¤ ë°˜í™˜
        getCategoryClass(category) {
          const categoryClassMap = {
            ë¦¬ë”ì‹­: "leader",
            ì¸ì‚¬ì´íŠ¸: "insight",
            ë¹„ì¦ˆíŠ¸ë Œë“œ: "biz",
          };
          return categoryClassMap[category] || "default";
        },

        // í‚¤ì›Œë“œ ë¶„ë¦¬ (ê³µë°±, ì‰¼í‘œ ë“±ìœ¼ë¡œ)
        splitKeywords(input) {
          return input
            .split(/[\s,\/\-]+/)
            .map((k) => k.trim())
            .filter((k) => k.length > 0);
        },

        // ë¬¸ìì—´ ìœ ì‚¬ë„ ê²€ì‚¬ (Levenshtein Distance)
        isSimilar(a, b, maxDistance = 1) {
          a = a.toLowerCase();
          b = b.toLowerCase();

          const dp = Array.from({ length: a.length + 1 }, () =>
            Array(b.length + 1).fill(0)
          );

          for (let i = 0; i <= a.length; i++) dp[i][0] = i;
          for (let j = 0; j <= b.length; j++) dp[0][j] = j;

          for (let i = 1; i <= a.length; i++) {
            for (let j = 1; j <= b.length; j++) {
              if (a[i - 1] === b[j - 1]) {
                dp[i][j] = dp[i - 1][j - 1];
              } else {
                dp[i][j] =
                  1 + Math.min(dp[i - 1][j], dp[i][j - 1], dp[i - 1][j - 1]);
              }
            }
          }

          return dp[a.length][b.length] <= maxDistance;
        },
      };

      // ============================================
      // ë¹„ë””ì˜¤ í•„í„°ë§ ë° ì •ë ¬
      // ============================================
      const VideoFilter = {
        // í‚¤ì›Œë“œ ë§¤ì¹­ ê²€ì‚¬ (ìœ ì—°í•œ ë§¤ì¹­)
        isVideoMatched(video, searchKeywords) {
          const videoWords = video.keywords.map((k) => k.toLowerCase());

          const searchWords = searchKeywords
            .map((kw) => Utils.splitKeywords(kw))
            .flat()
            .map((w) => w.toLowerCase());

          return searchWords.some((word) => {
            return videoWords.some((tag) => {
              // ì™„ì „ì¼ì¹˜
              if (tag === word) return true;

              // ìµœì†Œ 2ê¸€ì ì´ìƒ ë¶€ë¶„ ë§¤ì¹­ë§Œ í—ˆìš©
              if (word.length > 1 && tag.includes(word)) return true;

              // ìœ ì‚¬ë„ ê²€ìƒ‰ì€ 3ê¸€ì ì´ìƒì¼ ë•Œë§Œ
              if (word.length > 2 && Utils.isSimilar(tag, word, 1)) return true;

              return false;
            });
          });
        },

        // í‚¤ì›Œë“œì— ë§ëŠ” ì˜ìƒ í•„í„°ë§ ë° ì •ë ¬ (ìºì‹œ ì‚¬ìš©)
        getFilteredAndSortedVideos(forceRefresh = false) {
          // ìºì‹œê°€ ìˆê³  ê°•ì œ ìƒˆë¡œê³ ì¹¨ì´ ì•„ë‹ˆë©´ ìºì‹œ ë°˜í™˜
          if (STATE.cachedVideos.length > 0 && !forceRefresh) {
            return STATE.cachedVideos;
          }

          let matchedVideos = [];
          let unmatchedVideos = [];

          if (STATE.selectedKeywords.length === 0) {
            // í‚¤ì›Œë“œ ì—†ìœ¼ë©´ ì „ì²´ ëœë¤
            STATE.cachedVideos = Utils.shuffleArray(allVideos);
            return STATE.cachedVideos;
          }

          // ë§¤ì¹­ë˜ëŠ” ì˜ìƒê³¼ ë§¤ì¹­ë˜ì§€ ì•ŠëŠ” ì˜ìƒ ë¶„ë¦¬
          allVideos.forEach((video) => {
            if (this.isVideoMatched(video, STATE.selectedKeywords)) {
              matchedVideos.push(video);
            } else {
              unmatchedVideos.push(video);
            }
          });

          // ë§¤ì¹­ëœ ì˜ìƒì„ ë¨¼ì €, ë‚˜ë¨¸ì§€ë¥¼ ë’¤ì—
          const shuffledMatched = Utils.shuffleArray(matchedVideos);
          const shuffledUnmatched = Utils.shuffleArray(unmatchedVideos);

          STATE.cachedVideos = [...shuffledMatched, ...shuffledUnmatched];
          return STATE.cachedVideos;
        },

        // í˜„ì¬ í˜ì´ì§€ì˜ ì˜ìƒ ëª©ë¡ ê°€ì ¸ì˜¤ê¸°
        getCurrentPageVideos() {
          const sortedVideos = this.getFilteredAndSortedVideos();
          const startIndex = STATE.currentPage * STATE.VIDEOS_PER_PAGE;
          const endIndex = startIndex + STATE.VIDEOS_PER_PAGE;
          return sortedVideos.slice(startIndex, endIndex);
        },

        // ì „ì²´ í˜ì´ì§€ ìˆ˜ ê³„ì‚°
        getTotalPages() {
          const sortedVideos = this.getFilteredAndSortedVideos();
          return Math.ceil(sortedVideos.length / STATE.VIDEOS_PER_PAGE);
        },

        // ìºì‹œ ì´ˆê¸°í™” (í‚¤ì›Œë“œ ë³€ê²½ ì‹œ ì‚¬ìš©)
        clearCache() {
          STATE.cachedVideos = [];
        },
      };

      // ============================================
      // UI ë Œë”ë§
      // ============================================
      const VideoRenderer = {
        // ë¹„ë””ì˜¤ ì¹´ë“œ ìƒì„±
        createVideoCard(video) {
          const card = document.createElement("div");
          card.className = "video-card";

          const keywordTags = video.keywords
            .map((kw) => `<span class="key-badge">${kw}</span>`)
            .join(" ");

          const categoryClass = Utils.getCategoryClass(video.category);

          card.innerHTML = `<div class="card">
      <div class="thumbnail">
        <img src="https://img.youtube.com/vi/${video.id}/sddefault.jpg" />
      </div>
      <div class="txt-box">
        <div class="category ${categoryClass}">${video.category}</div>
        <div class="title">${video.title}</div>
        <div class="author">${keywordTags}</div>
      </div></div>
    `;

          return card;
        },

        // ì˜ìƒ ëª©ë¡ ë Œë”ë§
        renderVideos() {
          const container = document.getElementById("videoCardsContainer");
          const videos = VideoFilter.getCurrentPageVideos();

          container.innerHTML = "";

          videos.forEach((video, index) => {
            const card = this.createVideoCard(video);
            container.appendChild(card);

            setTimeout(() => {
              card.classList.add("show");
            }, index * 100);
          });

          Pagination.update();
        },
      };

      // ============================================
      // í˜ì´ì§€ë„¤ì´ì…˜
      // ============================================
      const Pagination = {
        // ë²„íŠ¼ ìƒíƒœ ì—…ë°ì´íŠ¸
        updateButtons() {
          const prevBtn = document.getElementById("prevBtn");
          const nextBtn = document.getElementById("nextBtn");
          const totalPages = VideoFilter.getTotalPages();

          if (STATE.currentPage === 0) {
            prevBtn.classList.add("disabled");
          } else {
            prevBtn.classList.remove("disabled");
          }

          if (STATE.currentPage >= totalPages - 1) {
            nextBtn.classList.add("disabled");
          } else {
            nextBtn.classList.remove("disabled");
          }
        },

        // í˜ì´ì§€ë„¤ì´ì…˜ ì •ë³´ ì—…ë°ì´íŠ¸
        update() {
          const pagination = document.getElementById("pagination");
          const totalPages = VideoFilter.getTotalPages();

          pagination.innerHTML = `<span class="current">${STATE.currentPage + 1}</span> / ${totalPages}`;
          this.updateButtons();
        },

        // í˜ì´ì§€ ë³€ê²½ (í˜ì´ë“œ íš¨ê³¼)
        async changePage() {
          const cardsContainer = document.getElementById("videoCardsContainer");

          cardsContainer.classList.add("fade-out");
          await new Promise((resolve) => setTimeout(resolve, 400));

          VideoRenderer.renderVideos();
          cardsContainer.classList.remove("fade-out");
        },
      };

      // ============================================
      // í‚¤ì›Œë“œ ê´€ë¦¬
      // ============================================
      const KeywordManager = {
        // í‚¤ì›Œë“œ ì¶”ê°€
        addKeyword(keyword) {
          if (!STATE.selectedKeywords.includes(keyword)) {
            STATE.selectedKeywords.push(keyword);
          }
        },

        // í‚¤ì›Œë“œ ì œê±°
        removeKeyword(keyword) {
          STATE.selectedKeywords = STATE.selectedKeywords.filter(
            (k) => k !== keyword
          );
        },

        // í‚¤ì›Œë“œ í† ê¸€ (ë‹¤ì¤‘ ì„ íƒ)
        toggleKeyword(keyword, isChecked) {
          if (isChecked) {
            this.addKeyword(keyword);
          } else {
            this.removeKeyword(keyword);
          }
        },

        // í‚¤ì›Œë“œ ë³€ê²½ í›„ í˜ì´ì§€ ë¦¬ì…‹ ë° ë Œë”ë§
        async updateVideosAfterKeywordChange() {
          STATE.currentPage = 0;
          VideoFilter.clearCache();
          await Pagination.changePage();
        },

        // ì²´í¬ë°•ìŠ¤ ìƒíƒœ ë™ê¸°í™”
        syncCheckboxStates() {
          document
            .querySelectorAll("#myKeyword input[type='checkbox']")
            .forEach((checkbox) => {
              const label = checkbox.closest("label");
              if (label) {
                const keywordText = label.textContent.trim().replace("#", "");
                checkbox.checked = STATE.selectedKeywords.includes(keywordText);
              }
            });
        },

        // ëª¨ë‹¬ ë‹«í ë•Œ í˜¸ì¶œ - syncKeywordsToList í›„ ì²´í¬ë°•ìŠ¤ ìƒíƒœ ì—…ë°ì´íŠ¸
        async syncAfterModalClose() {
          // kw_tag.jsì˜ syncKeywordsToListê°€ ì‹¤í–‰ëœ í›„
          // ìƒˆë¡œ ì¶”ê°€ëœ ì²´í¬ë°•ìŠ¤ë“¤ì˜ ìƒíƒœë¥¼ ë™ê¸°í™”
          this.syncCheckboxStates();

          // ì˜ìƒ ëª©ë¡ë„ ê°±ì‹ 
          await this.updateVideosAfterKeywordChange();
        },
      };

      // ============================================
      // ëª¨ë‹¬ ê´€ë¦¬
      // ============================================
      const ModalManager = {
        modal: null,
        settingsBtn: null,

        init() {
          this.modal = document.getElementById("keywordModal");
          this.settingsBtn = document.getElementById("keywordSettingsBtn");

          this.setupEventListeners();
        },

        setupEventListeners() {
          // ëª¨ë‹¬ ì—´ê¸°
          this.settingsBtn.onclick = () => {
            this.modal.style.display = "block";
          };

          // ëª¨ë‹¬ ì™¸ë¶€ í´ë¦­ ì‹œ ë‹«ê¸°
          this.modal.onclick = async (e) => {
            if (e.target === this.modal) {
              if (typeof syncKeywordsToList === "function") {
                syncKeywordsToList();
              }
              this.modal.style.display = "none";

              // ì§§ì€ ë”œë ˆì´ í›„ ë™ê¸°í™” (DOM ì—…ë°ì´íŠ¸ ëŒ€ê¸°)
              setTimeout(async () => {
                await KeywordManager.syncAfterModalClose();
              }, 50);
            }
          };
        },
      };

      // ============================================
      // ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì„¤ì •
      // ============================================
      const EventHandlers = {
        initialized: false,

        // ë„¤ë¹„ê²Œì´ì…˜ ë²„íŠ¼ ì´ë²¤íŠ¸
        setupNavigationButtons() {
          const prevBtn = document.getElementById("prevBtn");
          const nextBtn = document.getElementById("nextBtn");

          if (!prevBtn || !nextBtn) {
            console.error("ë²„íŠ¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤");
            return;
          }

          // ì´ì „ ë²„íŠ¼
          prevBtn.onclick = async (e) => {
            e.preventDefault();
            e.stopPropagation();

            if (STATE.currentPage > 0) {
              STATE.currentPage--;
              await Pagination.changePage();
            }
          };

          // ë‹¤ìŒ ë²„íŠ¼
          nextBtn.onclick = async (e) => {
            e.preventDefault();
            e.stopPropagation();

            const totalPages = VideoFilter.getTotalPages();
            if (STATE.currentPage < totalPages - 1) {
              STATE.currentPage++;
              await Pagination.changePage();
            }
          };
        },

        // í‚¤ì›Œë“œ ì²´í¬ë°•ìŠ¤ ì´ë²¤íŠ¸ (ì´ë²¤íŠ¸ ìœ„ì„ ë°©ì‹)
        setupKeywordCheckboxes() {
          const keywordList = document.getElementById("myKeyword");

          if (!keywordList) {
            console.error("myKeyword ìš”ì†Œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤");
            return;
          }

          // ë¶€ëª¨ ìš”ì†Œì— ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ë“±ë¡ (ì´ë²¤íŠ¸ ìœ„ì„)
          keywordList.onclick = async function (e) {
            // ì²´í¬ë°•ìŠ¤ê°€ í´ë¦­ëœ ê²½ìš°
            const checkbox = e.target;
            if (checkbox.type === "checkbox") {
              const label = checkbox.closest("label");
              if (label) {
                const keywordText = label.textContent.trim().replace("#", "");

                // checked ìƒíƒœëŠ” í´ë¦­ ì§í›„ì´ë¯€ë¡œ í˜„ì¬ ìƒíƒœ ì‚¬ìš©
                KeywordManager.toggleKeyword(keywordText, checkbox.checked);
                await KeywordManager.updateVideosAfterKeywordChange();
              }
            }
          };

          console.log("í‚¤ì›Œë“œ ì²´í¬ë°•ìŠ¤ ì´ë²¤íŠ¸ ë“±ë¡ ì™„ë£Œ (ì´ë²¤íŠ¸ ìœ„ì„)");
        },

        // ëª¨ë‹¬ ë‚´ í‚¤ì›Œë“œ íƒœê·¸ í´ë¦­ ì´ë²¤íŠ¸
        setupModalKeywordTags() {
          document.querySelectorAll(".keyword-tag > label").forEach((label) => {
            const checkbox = label.querySelector("input[type='checkbox']");

            if (checkbox) {
              checkbox.onchange = function () {
                const keywordText = label.textContent.trim().replace("#", "");

                if (!this.disabled) {
                  KeywordManager.toggleKeyword(keywordText, this.checked);
                }
              };
            }
          });
        },

        // ëª¨ë“  ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì„¤ì •
        init() {
          if (this.initialized) {
            return;
          }

          this.setupNavigationButtons();
          this.setupKeywordCheckboxes();
          this.setupModalKeywordTags();
          this.initialized = true;
        },
      };

      // ============================================
      // ì´ˆê¸°í™”
      // ============================================
      function initialize() {
        VideoRenderer.renderVideos();
        EventHandlers.init();
        ModalManager.init();
        KeywordManager.syncCheckboxStates();
      }

      // DOMContentLoaded ì‹œ í•œ ë²ˆë§Œ ì´ˆê¸°í™”
      if (document.readyState === "loading") {
        document.addEventListener("DOMContentLoaded", () => {
          initialize();

          // ì™¸ë¶€ í•¨ìˆ˜ í˜¸ì¶œ (kw_tag.js)
          if (typeof keywordChange === "function") {
            keywordChange();
          }
        });
      } else {
        initialize();

        if (typeof keywordChange === "function") {
          keywordChange();
        }
      }
    </script>
    >
  </body>
</html>
